[{"filePath":"E:\\Projects\\AimInelligence\\client\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\App.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'isSidebarOpen'. Either include it or remove the dependency array.","line":25,"column":6,"nodeType":"ArrayExpression","endLine":25,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [isSidebarOpen]","fix":{"range":[1009,1011],"text":"[isSidebarOpen]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport Sidebar from './components/Sidebar/Sidebar';\nimport ChatContainer from './components/Chat/ChatContainer';\nimport { ChatProvider } from './context/ChatContext';\nimport { ThemeProvider } from './context/ThemeContext';\nimport ModelSwitcher from './components/Common/ModelSwitcher';\nimport ThemeToggle from './components/Common/ThemeToggle';\nimport { PanelLeftOpen } from 'lucide-react';\n\nfunction App() {\n  const [isSidebarOpen, setIsSidebarOpen] = useState(window.innerWidth > 768);\n  const [isMobile, setIsMobile] = useState(window.innerWidth <= 768);\n\n  // Handle window resize\n  useEffect(() => {\n    const handleResize = () => {\n      const mobile = window.innerWidth <= 768;\n      setIsMobile(mobile);\n      if (!mobile && !isSidebarOpen) {\n        // Automatically open sidebar on desktop if it's closed\n      }\n    };\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  const toggleSidebar = () => setIsSidebarOpen(!isSidebarOpen);\n\n  return (\n    <ThemeProvider>\n      <ChatProvider>\n        <div className=\"flex h-screen bg-[var(--bg-primary)] text-[var(--text-primary)] overflow-hidden relative\">\n          {/* Mobile Backdrop */}\n          {isMobile && isSidebarOpen && (\n            <div\n              className=\"fixed inset-0 bg-black/50 z-30 transition-opacity duration-300 animate-fade-in-up\"\n              onClick={() => setIsSidebarOpen(false)}\n            />\n          )}\n\n          {/* Sidebar */}\n          <div className={`\n            fixed md:relative z-40 h-full transition-all duration-300 ease-out\n            ${isSidebarOpen ? 'translate-x-0 w-[280px]' : '-translate-x-full md:translate-x-0 w-0'}\n          `}>\n            <Sidebar isOpen={isSidebarOpen} toggle={toggleSidebar} />\n          </div>\n\n          {/* Main Content Area */}\n          <div className=\"flex-1 flex flex-col h-full relative min-w-0\">\n            {/* Premium Header Bar */}\n            <header className=\"absolute top-0 left-0 right-0 z-20 flex items-center justify-between px-4 py-3\">\n              {/* Left: Toggle Button */}\n              <div className=\"flex items-center gap-2\">\n                {!isSidebarOpen && (\n                  <button\n                    onClick={() => setIsSidebarOpen(true)}\n                    className=\"btn-icon\"\n                    aria-label=\"Open sidebar\"\n                  >\n                    <PanelLeftOpen className=\"w-5 h-5\" />\n                  </button>\n                )}\n              </div>\n\n              {/* Center: Logo & Model Selector */}\n              <div className=\"flex flex-col items-center gap-1\">\n                {!isSidebarOpen && (\n                  <div className=\"flex items-center justify-center mb-1\">\n                    <span className=\"text-xl font-bold tracking-tighter\">\n                      <span className=\"text-blue-500\">ai</span>\n                      <span className=\"text-[var(--text-primary)]\">fa</span>\n                    </span>\n                  </div>\n                )}\n                <div className=\"max-w-[200px] sm:max-w-none\">\n                  <ModelSwitcher />\n                </div>\n              </div>\n\n              {/* Right: Theme Toggle */}\n              <div className=\"flex items-center\">\n                <ThemeToggle />\n              </div>\n            </header>\n\n            {/* Chat Container */}\n            <ChatContainer />\n          </div>\n        </div>\n      </ChatProvider>\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\components\\Chat\\AttachmentPreview.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\components\\Chat\\ChatContainer.jsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  40 |         if (bottomRef.current) {\n  41 |             bottomRef.current.scrollIntoView({ behavior: 'auto' });\n> 42 |             setUserAutoScroll(true);\n     |             ^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  43 |             setShowScrollButton(false); // Explicitly hide button\n  44 |         }\n  45 |     }, [currentConversationId]); // Trigger explicitly on conversation ID change","line":42,"column":13,"nodeType":null,"endLine":42,"endColumn":30},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  49 |         const lastMsg = messages[messages.length - 1];\n  50 |         if (lastMsg && lastMsg.role === 'user') {\n> 51 |             setUserAutoScroll(true);\n     |             ^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  52 |             setShowScrollButton(false); // Explicitly hide button\n  53 |             if (bottomRef.current) {\n  54 |                 // Use smooth for user send action for better UX","line":51,"column":13,"nodeType":null,"endLine":51,"endColumn":30},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'messages'. Either include it or remove the dependency array.","line":58,"column":8,"nodeType":"ArrayExpression","endLine":58,"endColumn":25,"suggestions":[{"desc":"Update the dependencies array to be: [messages, messages.length]","fix":{"range":[2108,2125],"text":"[messages, messages.length]"}}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  66 |             bottomRef.current.scrollIntoView({ behavior: 'auto', block: 'end' });\n  67 |             // If we are auto-scrolling, button should be hidden\n> 68 |             if (showScrollButton) setShowScrollButton(false);\n     |                                   ^^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  69 |         }\n  70 |     }, [messages, streamingContent, thinkingContent, isThinking]); // Removed userAutoScroll from deps\n  71 |","line":68,"column":35,"nodeType":null,"endLine":68,"endColumn":54},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'showScrollButton' and 'userAutoScroll'. Either include them or remove the dependency array.","line":70,"column":8,"nodeType":"ArrayExpression","endLine":70,"endColumn":65,"suggestions":[{"desc":"Update the dependencies array to be: [messages, streamingContent, thinkingContent, isThinking, userAutoScroll, showScrollButton]","fix":{"range":[2732,2789],"text":"[messages, streamingContent, thinkingContent, isThinking, userAutoScroll, showScrollButton]"}}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useRef, useEffect } from 'react';\r\nimport { useChatContext } from '../../context/ChatContext';\r\nimport MessageItem from './MessageItem';\r\nimport InputArea from './InputArea';\r\nimport { ArrowDown, Sparkles, MessageCircle, Zap } from 'lucide-react';\r\n\r\nconst ChatContainer = () => {\r\n    const {\r\n        messages,\r\n        sendMessage,\r\n        stopStream,\r\n        isStreaming,\r\n        streamingContent,\r\n        thinkingContent,\r\n        thinkingDuration,\r\n        isThinking,\r\n        currentConversationId\r\n    } = useChatContext();\r\n\r\n    const bottomRef = useRef(null);\r\n    const scrollContainerRef = useRef(null);\r\n    const [showScrollButton, setShowScrollButton] = useState(false);\r\n    const [userAutoScroll, setUserAutoScroll] = useState(true);\r\n\r\n    // Combine historical messages with current streaming message\r\n    const displayMessages = [...messages];\r\n    if (isStreaming) {\r\n        displayMessages.push({\r\n            id: 'streaming-temp',\r\n            role: 'assistant',\r\n            content: streamingContent,\r\n            thinking: thinkingContent,\r\n            thinking_duration: thinkingDuration,\r\n            isStreaming: true\r\n        });\r\n    }\r\n\r\n    // Scroll to bottom on conversation change or initial load\r\n    useEffect(() => {\r\n        if (bottomRef.current) {\r\n            bottomRef.current.scrollIntoView({ behavior: 'auto' });\r\n            setUserAutoScroll(true);\r\n            setShowScrollButton(false); // Explicitly hide button\r\n        }\r\n    }, [currentConversationId]); // Trigger explicitly on conversation ID change\r\n\r\n    // Force auto-scroll when user sends a message (last message is user)\r\n    useEffect(() => {\r\n        const lastMsg = messages[messages.length - 1];\r\n        if (lastMsg && lastMsg.role === 'user') {\r\n            setUserAutoScroll(true);\r\n            setShowScrollButton(false); // Explicitly hide button\r\n            if (bottomRef.current) {\r\n                // Use smooth for user send action for better UX\r\n                bottomRef.current.scrollIntoView({ behavior: 'smooth' });\r\n            }\r\n        }\r\n    }, [messages.length]);\r\n\r\n    // Handle auto-scroll during streaming\r\n    useEffect(() => {\r\n        // Only trigger auto-scroll when content changes, not when userAutoScroll state changes\r\n        // This prevents the \"bounce back\" effect when manually scrolling to bottom\r\n        if (userAutoScroll && bottomRef.current) {\r\n            // Use auto (instant) during streaming to prevent jitter\r\n            bottomRef.current.scrollIntoView({ behavior: 'auto', block: 'end' });\r\n            // If we are auto-scrolling, button should be hidden\r\n            if (showScrollButton) setShowScrollButton(false);\r\n        }\r\n    }, [messages, streamingContent, thinkingContent, isThinking]); // Removed userAutoScroll from deps\r\n\r\n    // Handle scroll events\r\n    const handleScroll = () => {\r\n        if (scrollContainerRef.current) {\r\n            const { scrollTop, scrollHeight, clientHeight } = scrollContainerRef.current;\r\n            // Increased threshold to 250 to account for pb-48 (approx 192px) padding\r\n            const isNearBottom = scrollHeight - scrollTop - clientHeight < 250;\r\n\r\n            // Only update state if changed to prevent re-renders\r\n            if (isNearBottom !== userAutoScroll) {\r\n                setUserAutoScroll(isNearBottom);\r\n            }\r\n            if (!isNearBottom !== showScrollButton) {\r\n                setShowScrollButton(!isNearBottom);\r\n            }\r\n        }\r\n    };\r\n\r\n    const toBottom = () => {\r\n        if (bottomRef.current) {\r\n            bottomRef.current.scrollIntoView({ behavior: 'smooth' });\r\n            setUserAutoScroll(true);\r\n            setShowScrollButton(false);\r\n        }\r\n    };\r\n\r\n    const handleDelete = (id) => {\r\n        console.log(\"Delete message\", id);\r\n    };\r\n\r\n    const handleEdit = (id, newContent) => {\r\n        console.log(\"Edit message\", id, newContent);\r\n    };\r\n\r\n    // Suggestions for empty state\r\n    const suggestions = [\r\n        { icon: <MessageCircle className=\"w-4 h-4\" />, text: \"Explain quantum computing\", color: \"from-blue-500/20 to-cyan-500/20\" },\r\n        { icon: <Zap className=\"w-4 h-4\" />, text: \"Write Python code for a REST API\", color: \"from-amber-500/20 to-orange-500/20\" },\r\n        { icon: <Sparkles className=\"w-4 h-4\" />, text: \"Help me brainstorm ideas\", color: \"from-purple-500/20 to-pink-500/20\" },\r\n    ];\r\n\r\n    return (\r\n        <div className=\"relative flex-1 flex flex-col h-full overflow-hidden bg-[var(--bg-primary)]\">\r\n            {/* Messages Area */}\r\n            <div\r\n                ref={scrollContainerRef}\r\n                onScroll={handleScroll}\r\n                className=\"flex-1 overflow-y-auto scrollbar-thin pb-44 md:pb-52 pt-20\"\r\n            >\r\n                {displayMessages.length === 0 ? (\r\n                    <div className=\"h-full flex flex-col items-center justify-center px-6 animate-fade-in-up py-20 max-w-4xl mx-auto\">\r\n                        {/* Hero Section */}\r\n                        <div className=\"relative mb-10\">\r\n                            <div className=\"absolute inset-0 bg-emerald-500/20 blur-3xl rounded-full\" />\r\n                            <div className=\"relative w-20 h-20 rounded-2xl  flex items-center justify-center shadow-2xl shadow-emerald-500/20 transform hover:rotate-6 transition-transform duration-500\">\r\n                                {/* <Sparkles className=\"w-10 h-10 text-white\" /> */}\r\n                                <span className=\"text-8xl font-bold tracking-tighter\">\r\n                                    <span className=\"text-blue-500\">ai</span>\r\n                                    <span className=\"text-[var(--text-primary)]\">fa</span>\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <h1 className=\"text-3xl md:text-4xl font-extrabold mb-4 text-center tracking-tight text-[var(--text-primary)] leading-tight\">\r\n                            Welcome to <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-cyan-400\">Aim Intelligence</span>\r\n                        </h1>\r\n\r\n                        <p className=\"text-[var(--text-secondary)] text-base md:text-lg mb-12 text-center max-w-lg font-medium leading-relaxed\">\r\n                            How can I assist you today? Choose a path below or start typing to begin our conversation.\r\n                        </p>\r\n\r\n                        {/* Suggestion Cards */}\r\n                        <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4 w-full px-2 mt-4\">\r\n                            {suggestions.map((suggestion, idx) => (\r\n                                <button\r\n                                    key={idx}\r\n                                    onClick={() => sendMessage(suggestion.text)}\r\n                                    className={`group flex flex-col items-start gap-4 p-5 rounded-2xl border border-[var(--border-color)] bg-[var(--bg-secondary)] hover:bg-[var(--bg-tertiary)] hover:border-[var(--border-hover)] hover:translate-y-[-4px] transition-all duration-300 text-left shadow-lg shadow-black/10`}\r\n                                >\r\n                                    <div className={`p-2.5 rounded-xl bg-gradient-to-br ${suggestion.color} group-hover:scale-110 transition-transform`}>\r\n                                        <span className=\"text-[var(--text-primary)]\">\r\n                                            {suggestion.icon}\r\n                                        </span>\r\n                                    </div>\r\n                                    <span className=\"text-[14px] font-semibold text-[var(--text-secondary)] group-hover:text-[var(--text-primary)] transition-colors leading-snug\">\r\n                                        {suggestion.text}\r\n                                    </span>\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                ) : (\r\n                    displayMessages.map((msg, idx) => (\r\n                        <MessageItem\r\n                            key={msg.id}\r\n                            message={msg}\r\n                            onDelete={handleDelete}\r\n                            onEdit={handleEdit}\r\n                            isLast={idx === displayMessages.length - 1}\r\n                        />\r\n                    ))\r\n                )}\r\n                <div ref={bottomRef} className=\"h-4\" />\r\n            </div>\r\n\r\n            {/* Scroll to Bottom Button */}\r\n            {showScrollButton && (\r\n                <button\r\n                    onClick={toBottom}\r\n                    className=\"absolute bottom-48 left-1/2 -translate-x-1/2 p-3 rounded-full bg-[var(--bg-tertiary)] backdrop-blur-md border border-[var(--border-color)] shadow-2xl hover:bg-[var(--bg-hover)] hover:scale-110 active:scale-95 transition-all duration-300 z-10 animate-fade-in-up\"\r\n                    aria-label=\"Scroll to bottom\"\r\n                >\r\n                    <ArrowDown className=\"w-5 h-5 text-[var(--text-primary)]\" />\r\n                </button>\r\n            )}\r\n\r\n            {/* Input Area */}\r\n            <InputArea\r\n                onSend={sendMessage}\r\n                onStop={stopStream}\r\n                isStreaming={isStreaming}\r\n                disabled={isStreaming && !streamingContent && !isThinking}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ChatContainer;\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\components\\Chat\\CodeBlock.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\components\\Chat\\InputArea.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\components\\Chat\\MessageItem.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\components\\Chat\\ThinkingBlock.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\components\\Common\\ErrorBoundary.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'_error' is defined but never used.","line":9,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":43,"suggestions":[{"messageId":"removeVar","data":{"varName":"_error"},"fix":{"range":[244,250],"text":""},"desc":"Remove unused variable '_error'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\n\r\nclass ErrorBoundary extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = { hasError: false, error: null, errorInfo: null };\r\n    }\r\n\r\n    static getDerivedStateFromError(_error) {\r\n        return { hasError: true };\r\n    }\r\n\r\n    componentDidCatch(error, errorInfo) {\r\n        this.setState({ error, errorInfo });\r\n        console.error(\"Uncaught error:\", error, errorInfo);\r\n    }\r\n\r\n    render() {\r\n        if (this.state.hasError) {\r\n            return (\r\n                <div className=\"min-h-screen flex items-center justify-center bg-[#343541] text-white p-6\">\r\n                    <div className=\"max-w-xl w-full bg-[#444654] rounded-lg p-8 shadow-2xl border border-red-500/20\">\r\n                        <h1 className=\"text-2xl font-bold text-red-400 mb-4\">Something went wrong</h1>\r\n                        <p className=\"text-gray-300 mb-6\">The application crashed. Here are the details:</p>\r\n\r\n                        <pre className=\"bg-black/50 p-4 rounded text-red-300 text-sm overflow-auto max-h-60 mb-6 font-mono\">\r\n                            {this.state.error && this.state.error.toString()}\r\n                        </pre>\r\n\r\n                        <button\r\n                            onClick={() => window.location.reload()}\r\n                            className=\"bg-[#10a37f] hover:bg-[#0e906f] text-white px-4 py-2 rounded transition-colors\"\r\n                        >\r\n                            Reload Application\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return this.props.children;\r\n    }\r\n}\r\n\r\nexport default ErrorBoundary;\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\components\\Common\\Icons.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\components\\Common\\ModelSwitcher.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\components\\Common\\SettingsModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\components\\Common\\ThemeToggle.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\components\\Sidebar\\Sidebar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\context\\ChatContext.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'_err' is defined but never used.","line":105,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":105,"endColumn":22}],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":8,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":8,"endColumn":28,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-unused-vars","severity":2,"message":"'streamError' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":50,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":20,"suggestions":[{"messageId":"removeVar","data":{"varName":"streamError"},"fix":{"range":[1761,1835],"text":""},"desc":"Remove unused variable 'streamError'."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchModels'. Either include it or remove the dependency array.","line":62,"column":8,"nodeType":"ArrayExpression","endLine":62,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchModels]","fix":{"range":[2213,2215],"text":"[fetchModels]"}}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'currentConversationId' and 'messages.length'. Either include them or remove the dependency array.","line":193,"column":8,"nodeType":"ArrayExpression","endLine":193,"endColumn":21,"suggestions":[{"desc":"Update the dependencies array to be: [currentConversationId, isStreaming, messages.length]","fix":{"range":[6564,6577],"text":"[currentConversationId, isStreaming, messages.length]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useState, useEffect } from 'react';\r\nimport { useStreamResponse } from '../hooks/useStreamResponse';\r\nimport { api } from '../services/api';\r\n\r\nconst ChatContext = createContext();\r\n\r\n// eslint-disable-next-line react-refresh/only-export-components\r\nexport const useChatContext = () => useContext(ChatContext);\r\n\r\nexport const ChatProvider = ({ children }) => {\r\n    const [conversations, setConversations] = useState([]);\r\n    const [currentConversationId, setCurrentConversationId] = useState(null);\r\n    // Load from localStorage, or null until models are fetched\r\n    const [currentModel, setCurrentModel] = useState(() => {\r\n        return localStorage.getItem('selectedModel') || null;\r\n    });\r\n    const [availableModels, setAvailableModels] = useState([]);\r\n    const [gpuStatus, setGpuStatus] = useState('checking');\r\n    const [messages, setMessages] = useState([]);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [error, setError] = useState(null);\r\n    const [settings, setSettings] = useState(() => {\r\n        const saved = localStorage.getItem('ai-settings');\r\n        return saved ? JSON.parse(saved) : {\r\n            temperature: 0.7,\r\n            topP: 1,\r\n            maxTokens: 4096,\r\n            systemPrompt: ''\r\n        };\r\n    });\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem('ai-settings', JSON.stringify(settings));\r\n    }, [settings]);\r\n\r\n    const updateSettings = (newSettings) => {\r\n        setSettings(prev => ({ ...prev, ...newSettings }));\r\n    };\r\n\r\n    // Use the custom stream hook\r\n    const {\r\n        startStream,\r\n        stopStream,\r\n        isStreaming,\r\n        streamingContent,\r\n        thinkingContent,\r\n        isThinking,\r\n        thinkingDuration,\r\n        // eslint-disable-next-line no-unused-vars\r\n        streamError\r\n    } = useStreamResponse();\r\n\r\n    // Fetch models and GPU status on mount\r\n    useEffect(() => {\r\n        fetchModels();\r\n        checkGPUStatus();\r\n\r\n        // Periodically check GPU status\r\n        const interval = setInterval(checkGPUStatus, 30000);\r\n        return () => clearInterval(interval);\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    // Fetch initial conversations\r\n    useEffect(() => {\r\n        fetchConversations();\r\n    }, []);\r\n\r\n    // Load messages when conversation changes\r\n    useEffect(() => {\r\n        if (currentConversationId) {\r\n            loadMessages(currentConversationId);\r\n        } else {\r\n            setMessages([]);\r\n        }\r\n    }, [currentConversationId]);\r\n\r\n    const fetchModels = async () => {\r\n        try {\r\n            const data = await api.getModels();\r\n            const models = data.models || [];\r\n            setAvailableModels(models);\r\n\r\n            // Auto-select model: savedModel > defaultModel > first available\r\n            const savedModel = localStorage.getItem('selectedModel');\r\n            if (savedModel && models.find(m => m.name === savedModel)) {\r\n                setCurrentModel(savedModel);\r\n            } else if (data.defaultModel && models.find(m => m.name === data.defaultModel)) {\r\n                setCurrentModel(data.defaultModel);\r\n            } else if (models.length > 0 && !currentModel) {\r\n                // Select first available model if none set\r\n                setCurrentModel(models[0].name);\r\n            }\r\n        } catch (err) {\r\n            console.error('Failed to fetch models:', err);\r\n            // Don't set fake fallback models - let the UI show \"No models available\"\r\n            setAvailableModels([]);\r\n        }\r\n    };\r\n\r\n    const checkGPUStatus = async () => {\r\n        try {\r\n            const data = await api.getGPUStatus();\r\n            setGpuStatus(data.status);\r\n        } catch (_err) {\r\n            setGpuStatus('disconnected');\r\n        }\r\n    };\r\n\r\n    const fetchConversations = async () => {\r\n        try {\r\n            setIsLoading(true);\r\n            const data = await api.getConversations();\r\n            setConversations(data);\r\n        } catch (err) {\r\n            console.error('Failed to fetch conversations:', err);\r\n            setError('Failed to load conversations');\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const loadMessages = async (id) => {\r\n        try {\r\n            setIsLoading(true);\r\n            const data = await api.getConversation(id);\r\n            setMessages(data.messages || []);\r\n        } catch (err) {\r\n            console.error('Failed to load messages:', err);\r\n            setError('Failed to load messages');\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const createNewChat = async () => {\r\n        try {\r\n            const data = await api.createConversation({ model: currentModel });\r\n            setConversations(prev => [data, ...prev]);\r\n            setCurrentConversationId(data.id);\r\n            setMessages([]);\r\n            return data.id;\r\n        } catch (err) {\r\n            console.error('Failed to create chat:', err);\r\n            return null;\r\n        }\r\n    };\r\n\r\n    const sendMessage = async (content, attachments = []) => {\r\n        let conversationId = currentConversationId;\r\n\r\n        // Create new chat if none selected\r\n        if (!conversationId) {\r\n            conversationId = await createNewChat();\r\n            if (!conversationId) return;\r\n        }\r\n\r\n        // Optimistic update\r\n        const userMessageId = `temp-${Date.now()}`;\r\n        const userMessage = {\r\n            id: userMessageId,\r\n            role: 'user',\r\n            content,\r\n            attachments,\r\n            created_at: new Date().toISOString()\r\n        };\r\n\r\n        setMessages(prev => [...prev, userMessage]);\r\n\r\n        // Start streaming response\r\n        try {\r\n            await startStream({\r\n                conversationId,\r\n                message: content,\r\n                model: currentModel,\r\n                options: settings,\r\n                attachments\r\n            });\r\n        } catch (err) {\r\n            console.error('Send message failed:', err);\r\n            setError(err.message);\r\n        }\r\n    };\r\n\r\n    // Refresh messages after stream ends\r\n    useEffect(() => {\r\n        if (!isStreaming && currentConversationId && messages.length > 0) {\r\n            // Re-fetch to ensure consistency with DB\r\n            loadMessages(currentConversationId);\r\n            fetchConversations(); // Update sidebar with new title if generated\r\n        }\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [isStreaming]);\r\n\r\n    const deleteConversation = async (id) => {\r\n        try {\r\n            await api.deleteConversation(id);\r\n            setConversations(prev => prev.filter(c => c.id !== id));\r\n            if (currentConversationId === id) {\r\n                setCurrentConversationId(null);\r\n                setMessages([]);\r\n            }\r\n        } catch (err) {\r\n            console.error('Failed to delete conversation:', err);\r\n        }\r\n    };\r\n\r\n    const selectModel = (modelName) => {\r\n        setCurrentModel(modelName);\r\n        localStorage.setItem('selectedModel', modelName);\r\n    };\r\n\r\n    return (\r\n        <ChatContext.Provider value={{\r\n            conversations,\r\n            currentConversationId,\r\n            setCurrentConversationId,\r\n            currentModel,\r\n            setCurrentModel: selectModel,\r\n            availableModels,\r\n            gpuStatus,\r\n            messages,\r\n            setMessages,\r\n            sendMessage,\r\n            createNewChat,\r\n            deleteConversation,\r\n            isLoading,\r\n            isStreaming,\r\n            stopStream,\r\n            streamingContent,\r\n            thinkingContent,\r\n            isThinking,\r\n            thinkingDuration,\r\n            settings,\r\n            updateSettings,\r\n            error,\r\n            refreshModels: fetchModels\r\n        }}>\r\n            {children}\r\n        </ChatContext.Provider>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\context\\ThemeContext.jsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":6,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":6,"endColumn":22,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\hooks\\useStreamResponse.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\main.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\src\\services\\api.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"E:\\Projects\\AimInelligence\\client\\vite.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]
